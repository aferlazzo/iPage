<?php
/*

Perfect Response - Email Marketing at Its Best!
Copyright © Tony Ferlazzo 2004 
Version 1.0 Written by: Tony Ferlazzo, tony@lightning-mortgage.com

*/

include("check1.php");
?>
<HTML>
<HEAD>
<TITLE>Perfect Response home</TITLE>
<meta name="robots" content="NoIndex, NoFollow">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<style type="text/css" media="screen">
@import "PerfectResponse.css";
</style>
<script language="JavaScript1.2">
function LLogout()
{
	if (confirm('Do you really want to logout?')) 
		location.href='logout.php';
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
//																										/
//	Review the Standard Documnent Object Model for Javascript Event Handler background					/
//																										/
//	HighlightPageRow: This is an event handler for mouse clicking, depending on theAction. When the 	/
//	mouse passes over the row this handler controls, the color of the cells in the row are changed 		/
//	to thePointerColor. When the area is clicked, the color of the cells change to theMarkedColor. 		/
//	When a marked row is clicked on a second time, the color of the cells is reset to theDefaultColor.	/
//																										/
//	All major browsers are supported.																	/
//																										/
////////////////////////////////////////////////////////////////////////////////////////////////////////

function HighlightPageRow(theRow, theRowNumber, theAction, theDefaultColor, thePointerColor, theMarkColor)
{

/**
 * This array is used to remember mark status of rows in browse mode
 */
	var markedRow = new Array;
	var linkNumber = 13 + theRowNumber;
	//alert ("document.links[" + linkNumber + "] " + document.links[linkNumber]);
	
	//alert("theDefaultColor:" + theDefaultColor + " thePointerColor:" + thePointerColor + " theMarkColor:" + theMarkColor);
	var theCells = null;

	// 1. Pointer and mark feature are disabled or the browser can't get the
	//	row -> exits
	if ((thePointerColor == '' && theMarkColor == '') || typeof(theRow.style) == 'undefined') 
	{
		alert("Exit 1");
		return -1;
	}

	// 2. Gets the current row and exits if the browser can't get it
	if (typeof(document.getElementsByTagName) != 'undefined') 
	{
		theCells = theRow.getElementsByTagName('td');
	}
	else if (typeof(theRow.cells) != 'undefined') 
	{
		theCells = theRow.cells;
	}
	else 
	{
		alert("Exit 2");	
		return -1;
	}

	// 3. Gets the current color...
	var rowCellsCount = theCells.length;
	var domDetect	 = null;
	var currentColor	= null;
	var newColor		= null;
	
	
	// 3.1 ... with DOM compatible browsers except Opera that does not return
	//		 valid values with "getAttribute"
	if (typeof(window.opera) == 'undefined'	&& typeof(theCells[0].getAttribute) != 'undefined') 
	{
		currentColor = theCells[0].getAttribute('bgcolor'); //we want to use the gray color of column 0
		domDetect	= true;
	}
	// 3.2 ... with other browsers
	else 
	{
		currentColor = theCells[0].style.backgroundColor; //we want to use the gray color of column 0
		domDetect	= false;
	} // end 3

	//alert("domDetect " + domDetect);
	//alert("currentColor:" + currentColor + " theDefaultColor:" + theDefaultColor + " thePointerColor:" + thePointerColor + " theMarkColor:" + theMarkColor);


	// 4. Defines the new color
	// 4.1 If Current color is null or the current color equals the default color
	if (currentColor == '' || currentColor.toLowerCase() == theDefaultColor.toLowerCase()) 
	{
		//alert("theAction:" + theAction);
		
		if (theAction == 'over' && thePointerColor != '') //if it is a mouseover and thePointerColor is not empty
		{
			newColor				= thePointerColor;	//use the pointer color
			//alert("4.1 over, newColor:" + newColor);
		}
		else if (theAction == 'click' && theMarkColor != '') //if the mouse was clicked and the line was marked
		{
			newColor				= theMarkColor;
			markedRow[theRowNumber] = true;
			
			//alert("4.1 click, newColor else:" + newColor);
		}
		
		// don't set current color
		
	}
	
	// 4.1.2 Current color is the pointer one
	else if (currentColor.toLowerCase() == thePointerColor.toLowerCase()
			 && (typeof(markedRow[theRowNumber]) == 'undefined' || !markedRow[theRowNumber])) 
	{
		//alert("theAction:" + theAction);
		
		if (theAction == 'out') 
		{
				newColor				= theDefaultColor; // if the row is set to pointerColor and not marked OR marked already
				//alert("4.1.2 out, newColor:" + newColor);
		}
		else if (theAction == 'click' && theMarkColor != '') 
		{
			newColor				= theMarkColor;
			markedRow[theRowNumber] = true;
			location.href=document.links[linkNumber];	//transfer control to the page referenced by the link on the clicked row
			//alert("4.1.2 click, newColor else:" + newColor);
		}
	}
	
	// 4.1.3 Current color is the marker one
	else if (currentColor.toLowerCase() == theMarkColor.toLowerCase()) 
	{
		if (theAction == 'click') 
		{
			newColor				= (thePointerColor != '')	//expression: if there is a pointer color
									? thePointerColor		 	//if true, use this value	
									: theDefaultColor;		//if false, use this value
									
			markedRow[theRowNumber] = (typeof(markedRow[theRowNumber]) == 'undefined' || !markedRow[theRowNumber])
									? true
									: null;
			//alert("4.1.3 newColor:" + newColor);
		}
	} // end 4

	
	// 5. Sets the new color...
	if (newColor) 
	{			 /////////////////////////
		//rowCellsCount = 3; //this will limit the change of background color to column 3
		//alert("Number of cells in row is: " + theCells.length);
				 /////////////////////////
		var c = 0;
		// 5.1 ... with DOM compatible browsers except Opera
		if (domDetect) 
		{
			for (c = 0; c < rowCellsCount; c++) 
			{
				theCells[c].setAttribute('bgcolor', newColor, 0); // change background color 
			} // end for loop
		}
		// 5.2 ... with other browsers
		else 
		{
			for (c = 0; c < rowCellsCount; c++) 
			{
				theCells[c].style.backgroundColor = newColor;
			}
		}
	} // end 5
	
	
} // end of the 'HighlightPageRow()' function
</script>
</HEAD>
<BODY leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<TABLE width='540' BORDER='0' CELLPADDING='4' CELLSPACING=0 align="center">
	<tr> 
		<td colspan='2'align='center'>
			<h2><i>Perfect Response</i> - Email Marketing at its best!</h2>
		</td>
	</tr>
	<tr>
		<td colspan='2' align='center'>
			<h3 style="font-size: medium">Please select an option:</h3>
		</td>
	</tr>
		
		<script language="Javascript">var RowOnPage=0;</script>
	
	<tr	onmouseover="HighlightPageRow(this,	RowOnPage,'over', '#99ff99', '#66cc66', '#99ff99');" 
		onmouseout="HighlightPageRow(this,	RowOnPage++, 'out', '#99ff99', '#66cc66', '#99ff99');"
		onmousedown="location.href='manar.php'">
		<td width='20%'>&nbsp;</td>
		<td>
			<a href="manar.php">Manage Email Campaigns</a> - Both messages and subscribers
		</td>
	</tr>
	<tr	onmouseover="HighlightPageRow(this,	RowOnPage,'over', '#99ff99', '#66cc66', '#99ff99');" 
		onmouseout="HighlightPageRow(this,	RowOnPage++, 'out', '#99ff99', '#66cc66', '#99ff99');"
		onmousedown="location.href='DisplayLog.php'">
		<td width='20%'>&nbsp;</td>
		<td>
			<a href="DisplayLog.php">Display Activity Log</a> 
		<?php	 
			$Size = filesize('PerfectResponseLog.txt');
			print("- the log is ");
			
			if ($Size > 0)
			{
				$Size = round($Size/1024, 2);
				print("$Size K bytes");
			}
			else
			{
				print("empty");
			}
		?>
		</td>
	</tr>
	<tr	onmouseover="HighlightPageRow(this,	RowOnPage,'over', '#99ff99', '#66cc66', '#99ff99');" 
		onmouseout="HighlightPageRow(this,	RowOnPage++, 'out', '#99ff99', '#66cc66', '#99ff99');"
		onmousedown="location.href='setdb.php'">
		<td width='20%'>&nbsp;</td>
		<td>				
			<a href="setdb.php">Edit Perfect Response Configuration</a>
		</td>
	</tr>
	<tr	onmouseover="HighlightPageRow(this,	RowOnPage,'over', '#99ff99', '#66cc66', '#99ff99');" 
		onmouseout="HighlightPageRow(this,	RowOnPage++, 'out', '#99ff99', '#66cc66', '#99ff99');"
		onmousedown="location.href='DisplayLog.php?Command=B'">
		<td width='20%'>&nbsp;</td>
		<td>
			<a href="DisplayLog.php?Command=B">Backup and reset Activity Log</a>			
		</td>
	</tr>
	<tr	onmouseover="HighlightPageRow(this,	RowOnPage,'over', '#99ff99', '#66cc66', '#99ff99');" 
		onmouseout="HighlightPageRow(this,	RowOnPage++, 'out', '#99ff99', '#66cc66', '#99ff99');"
		onmousedown="location.href='PerfectResponseAdmin.php'">
		<td width='20%'>&nbsp;</td>
		<td>
			<a href="PerfectResponseAdmin.php">Change <i>Perfect Response</i> Admin password</a>
		</td>
	</tr>
	<tr	onmouseover="HighlightPageRow(this,	RowOnPage,'over', '#99ff99', '#66cc66', '#99ff99');" 
		onmouseout="HighlightPageRow(this,	RowOnPage++, 'out', '#99ff99', '#66cc66', '#99ff99');"
		onmousedown="LLogout();">
		<td width='20%'>&nbsp;</td>
		<td>
			<span style="color: #039; font-weight: bold;">Logout</span>
		 </td>
	</tr>
	<tr>
		<td colspan='2'>&nbsp;</td>
</table>
</BODY>
</HTML>
